function(add_sycl_library source_file)
    add_library(${source_file} STATIC "${source_file}.cpp")
    target_link_libraries(${source_file} PUBLIC Static_RNG::Static_RNG TBB::tbb cppitertools)
    target_compile_options(${source_file} PUBLIC ${SYCL_COMPILE_OPTIONS})
    target_compile_options(${source_file} PUBLIC ${DEFAULT_WARNING_FLAGS})
    target_compile_options(${source_file} PRIVATE ${DPCPP_FLAGS} -sycl-std=2020 -std=c++20 -fsycl-unnamed-lambda)
    target_include_directories(${source_file} PUBLIC ${SYCL_GRAPH_INCLUDE_DIR})
    if(${SYCL_GRAPH_USE_CUDA})
        target_compile_options(${source_file} PRIVATE ${SYCL_CUDA_FLAGS})
        target_link_options(${source_file} PRIVATE ${SYCL_CUDA_FLAGS})
    endif()
    target_link_options(${source_file} PRIVATE ${DPCPP_FLAGS} -sycl-std=2020 -std=c++20 -fsycl-unnamed-lambda)
endfunction()

add_sycl_library(SBM_types)
add_sycl_library(SBM_Generation)
target_link_libraries(SBM_Generation PUBLIC SBM_types)
add_library(Graph STATIC Graph.cpp)
target_link_libraries(Graph PRIVATE cppitertools)
target_include_directories(Graph PUBLIC ${SYCL_GRAPH_INCLUDE_DIR})
add_sycl_library(Buffer_Utils)
add_library(Regression STATIC Regression.cpp)
target_link_libraries(Regression PRIVATE ortools::ortools)
target_link_libraries(Regression PUBLIC Eigen3::Eigen)
target_include_directories(Regression PUBLIC ${SYCL_GRAPH_INCLUDE_DIR})

add_sycl_library(SIR_Dynamics)
target_link_libraries(SIR_Dynamics PRIVATE Buffer_Utils)
add_sycl_library(SIR_Infection_Sampling)
add_sycl_library(Simulation)
target_link_libraries(Simulation PRIVATE SIR_Dynamics SIR_Infection_Sampling Buffer_Utils Graph)
add_library(Sycl_Graph INTERFACE)
target_link_libraries(Sycl_Graph INTERFACE SIR_Dynamics SIR_Infection_Sampling Buffer_Utils Graph Simulation Regression)
